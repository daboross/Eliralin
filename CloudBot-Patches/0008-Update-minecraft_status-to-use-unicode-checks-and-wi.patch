From 9d290774e761ce7b53568188879a69ca8ab45e3c Mon Sep 17 00:00:00 2001
From: Dabo Ross <daboross@daboross.net>
Date: Mon, 13 Jan 2014 23:05:12 -0800
Subject: [PATCH] Update minecraft_status to use unicode checks, and with a new
 format.


diff --git a/plugins/minecraft_status.py b/plugins/minecraft_status.py
index 98fce4a..a1aeca8 100644
--- a/plugins/minecraft_status.py
+++ b/plugins/minecraft_status.py
@@ -3,9 +3,15 @@ import json
 
 
 @hook.command(autohelp=False)
+@hook.command("mcs", autohelp=False)
 def mcstatus(inp):
     """mcstatus -- Checks the status of various Mojang (the creators of Minecraft) servers."""
 
+    yes_prefix = u"\x02\x0f"
+    yes_suffix = u": \x033\x02\u2714"
+    no_prefix = u"\x02\x0f"
+    no_suffix = u": \x034\x02\u2716"
+
     try:
         request = http.get("http://status.mojang.com/check")
     except (http.URLError, http.HTTPError) as e:
@@ -14,25 +20,21 @@ def mcstatus(inp):
     # lets just reformat this data to get in a nice format
     data = json.loads(request.replace("}", "").replace("{", "").replace("]", "}").replace("[", "{"))
 
-    out = []
-
     # use a loop so we don't have to update it if they add more servers
-    yes = []
-    no = []
+    servers = []
     for server, status in data.items():
+        if server == "minecraft.net":
+            server = "MC|Website"
+        elif server.endswith(".mojang.com"):
+            server = "MJ|{}".format(server[:-11].capitalize())
+        elif server.endswith(".minecraft.net"):
+            server = "MC|{}".format(server[:-14].capitalize())
+
         if status == "green":
-            yes.append(server)
+            servers.append(u"{}{}{}".format(yes_prefix, server, yes_suffix))
         else:
-            no.append(server)
-    if yes:
-        out = "\x033\x02Online\x02\x0f: " + ", ".join(yes)
-        if no:
-            out += " "
-    if no:
-        out += "\x034\x02Offline\x02\x0f: " + ", ".join(no)
-
-    return "\x0f" + out.replace(".mojang.com", ".mj") \
-                       .replace(".minecraft.net", ".mc")
+            servers.append(u"{}{}{}".format(no_prefix, server, no_suffix))
+    return "  ".join(servers)
 
 
 @hook.command("haspaid")
-- 
1.8.5.3

